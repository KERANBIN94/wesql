# wesql 数据库项目 - TODO 列表

此文件用于跟踪 wesql 数据库的未来改进和缺失功能。

## 高优先级

- [x] **存储层：支持多页表**
  - [x] 实现一个“空闲空间管理器”（Free Space Map）来跟踪页面上的可用空间。
  - [x] 修改 `StorageEngine::insert_record` 以查找有可用空间的页面，或在需要时分配新页面。
  - [x] 允许表文件的大小增长超过一个页面。

- [x] **数据类型：支持多种数据类型**
  - [x] 在 `Record` 结构中使用 `std::variant` 或自定义的 `Value` 类来代替 `std::string`。
  - [x] 在数据库元数据中存储 `CREATE TABLE` 语句定义的列类型信息。
  - [x] 实现类型感知的序列化、反序列化和比较逻辑。

## 中优先级

- [x] **SQL 解析器：功能扩展**
  - [x] 在 `sql_parser.cpp` 中添加对 `CREATE INDEX ... ON ... (...)` 语法的支持。
  - [x] 扩展 `WHERE` 子句解析器以支持更多运算符（如 `<`、`>`、`!=`、`LIKE`）和 `OR` 逻辑。
  - [x] 添加对 `DROP TABLE` 和 `DROP INDEX` 语句的支持。
  - [x] 添加对 `BEGIN`、`COMMIT` 和 `ROLLBACK` 作为显式 SQL 命令的支持。

- [x] **事务：垃圾回收**
  - [x] 设计并实现一个 `VACUUM`（清理）进程。
  - [x] `VACUUM` 进程应扫描表以查找并移除“死”元组（来自已中止的事务或已更新行的旧版本）。
  - [x] 回收死元组占用的空间以供将来使用。

## 低优先级 / 未来构想

- [ ] **SQL 功能：高级查询**
  - [ ] 实现 `JOIN` 操作（例如，嵌套循环连接、哈希连接）。
  - [ ] 实现 `GROUP BY` 和聚合函数（`COUNT`, `SUM`, `AVG` 等）。
  - [ ] 实现 `ORDER BY` 对结果进行排序。

- [ ] **并发：锁/闩机制**
  - [ ] 分析和改进并发性能。虽然缓冲缓存有互斥锁，但更高级别的并发操作可能需要页面级或记录级的锁定。
